{{ template "head" dict "Title" "Pipelines" }}
<!-- Breadcrumb navigation -->
<nav
  class="px-3 py-2 sm:px-4 sm:py-3 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 flex items-center gap-1 sm:gap-2 flex-wrap text-sm sm:text-base"
  role="navigation"
  aria-label="Breadcrumb">
  <span class="text-gray-800 dark:text-white font-medium">Pipelines</span>
</nav>

<main id="main-content" role="main">
  <div class="container mx-auto p-4">
    <div
      class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between mb-6">
      <div>
        <h1 class="text-3xl font-bold dark:text-white">Pipelines</h1>
        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Manage and
          trigger your CI/CD pipelines. Select a pipeline to view its runs.</p>
      </div>
      <div class="text-sm text-gray-600 dark:text-gray-400">
        {{ .Pagination.TotalItems }} pipeline{{ if ne .Pagination.TotalItems 1
        }}s{{ end }}
      </div>
    </div>

    <!-- Search box -->
    <div class="mb-4">
      <div class="relative max-w-md">
        <svg
          class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none w-4 h-4"
          viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
          <path fill-rule="evenodd"
            d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
            clip-rule="evenodd" />
        </svg>
        <input
          type="search"
          name="q"
          id="pipeline-search"
          class="w-full py-2 pr-3 pl-10 border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-white dark:bg-gray-800 text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"
          placeholder="Search pipelines by name or contentâ€¦"
          value="{{ .Query }}"
          aria-label="Search pipelines"
          autocomplete="off"
          hx-get="/pipelines/search/"
          hx-trigger="input changed delay:300ms, search"
          hx-target="#pipelines-content"
          hx-swap="morph:innerHTML">
      </div>
    </div>

    <div id="pipelines-list">
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden">
        <div
          id="pipelines-content"
          hx-get="/pipelines/search/"
          hx-trigger="every 5s"
          hx-target="this"
          hx-swap="morph:innerHTML"
          hx-include="#pipeline-search, #pipeline-page, #pipeline-per-page">
          {{ template "_pipelines_content" . }}
        </div>
      </div>
    </div>
  </div>
</main>

{{ template "footer" }}
{{ template "toast-container" }}
{{ template "end" }}
